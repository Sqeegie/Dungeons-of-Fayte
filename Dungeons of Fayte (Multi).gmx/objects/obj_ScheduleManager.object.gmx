<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>40</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>{
    P1Choice = obj_Null;
    P2Choice = obj_Null;
    P3Choice = obj_Null;
    P4Choice = obj_Null;

    stage = 0;
    advance = 0;
    
    currentLevel = 0;
    setLevel = 0;
    
    myEvent = obj_Null;
    
    showedText = 0;
    
    currentLevel = 0;
    setLevel = 0;
}</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>{
    StartStore();



}</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>{
    /*if(Week == 0 &amp;&amp; showedText == 0)
    {
        if(currentLevel == 0)
        {
            pause = 1;
            currentLevel = 1;
        }
        
        if(currentLevel &gt; setLevel)
        {
            setLevel +=1;
            
            if(currentLevel == 1)
            {
                var newobj;
                newobj = instance_create(view_xview+48,view_yview+128,obj_TextBox);
                newobj.owner = id;
                newobj.portrait = spr_OldManPort;
                newobj.text = '"Good, you made it back to town safely."';
                newobj.x = view_xview+64;
                newobj.y = view_xview+128;
            }
            
            if(currentLevel == 2)
            {
                var newobj;
                newobj = instance_create(view_xview+48,view_yview+128,obj_TextBox);
                newobj.owner = id;
                newobj.portrait = spr_OldManPort;
                newobj.text = '"Spend your time in town wisely, as you will have another dungeon outing at the end of the month"';
                newobj.x = view_xview+64;
                newobj.y = view_xview+128;
            }
            
            if(currentLevel == 3)
            {
                var newobj;
                newobj = instance_create(view_xview+48,view_yview+128,obj_TextBox);
                newobj.owner = id;
                newobj.portrait = spr_OldManPort;
                newobj.text = '"Work at various places around town to build up your skills, or train if you can afford it. Be sure to visit the shop too!"';
                newobj.x = view_xview+64;
                newobj.y = view_xview+128;
            }
            
            if(currentLevel == 4)
            {
                pause = 0;
                showedText = 1;
                currentLevel = 0;
                setLevel = 0;
            
            }
        
        }
        
    }*/


    if(stage == 0)
    {
        switch(numPlayers)
        {
            case 1:
                if(P1Choice != obj_Null)
                {
                    pause = 1;
                    stage = 1;
                    advance = 1;
                    RemoveFromLocations();
                }
                break;
            case 2:
                if(P1Choice != obj_Null &amp;&amp; P2Choice != obj_Null)
                {
                    pause = 1;
                    stage = 1;
                    advance = 1;
                    RemoveFromLocations();
                }
                break;
            case 3:
                if(P1Choice != obj_Null &amp;&amp; P2Choice != obj_Null &amp;&amp; P3Choice != obj_Null)
                {
                    pause = 1;
                    stage = 1;
                    advance = 1;
                    RemoveFromLocations();
                }
                break;
            case 4:
                if(P1Choice != obj_Null &amp;&amp; P2Choice != obj_Null &amp;&amp; P3Choice != obj_Null &amp;&amp; P4Choice != obj_Null)
                {
                    pause = 1;
                    stage = 1;
                    advance = 1;
                    RemoveFromLocations();
                }
                break;
        }
    }

    if(stage &gt; numPlayers)
    {
        Week +=1;
        view_xview = 0;
        view_yview = 0;
        ZoomOut();
        TeleportPlayers(104,104);
        currentLevel = 0;
        setLevel = 0;
        stage = 0;
        pause = 0;
        P1Choice = obj_Null;
        P2Choice = obj_Null;
        P3Choice = obj_Null;
        P4Choice = obj_Null;
        
        var tempcost;
        tempcost = 0;
        
        if(CheckFlag('TF_CostChange1') &gt; 0)
        {
            tempcost += 0.15;
        }
        
        if(CheckFlag('TF_CostChange2') &gt; 0)
        {
            tempcost += 0.15;
        }
        
        if(CheckFlag('TF_CostChange3') &gt; 0)
        {
            tempcost += 0.2;
        }
        
        costMultiplier = 1-tempcost;
    
        if(Week == 4 || Week == 8 || Week == 12 || Week == 16)
        {
            pause = 1;
            obj_Voter1.kill = 1;
            obj_Voter2.kill = 1;
            obj_Voter3.kill = 1;
            obj_Voter4.kill = 1;
            
            dungeonGo = 1;
            instance_create(0,0,obj_DungeonWarn);
        
        
        }
    }
    else
    {
        switch(stage)
        {
            case 1:
                TownEventManage(obj_P1,P1Choice);
                break;
            case 2:
                TownEventManage(obj_P2,P2Choice);
                break;
            case 3:
                TownEventManage(obj_P3,P3Choice);
                break;
            case 4:
                TownEventManage(obj_P4,P4Choice);
                break;
            case 5:
                Week +=1;
                view_xview = 0;
                view_yview = 0;
                ZoomOut();
                TeleportPlayers(128,96);
                currentLevel = 0;
                setLevel = 0;
                stage = 0;
                pause = 0;
                P1Choice = obj_Null;
                P2Choice = obj_Null;
                P3Choice = obj_Null;
                P4Choice = obj_Null;
                
                if(Week == 4 || Week == 8 || Week == 12 || Week == 16)
                {
                    pause = 1;
                    obj_Voter1.kill = 1;
                    obj_Voter2.kill = 1;
                    obj_Voter3.kill = 1;
                    obj_Voter4.kill = 1;
                    
                    instance_create(0,0,obj_DungeonWarn);
                
                
                }
        }
    }



}</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>{
    SS_StopSound(global.sound_handle);

    global.sound_handle = SS_LoadSound(program_directory + "\music\mus_Town.ogg", 1);
    
    SS_SetSoundVol(global.sound_handle, 10000); // Might happen that it should be 0, I don't remember
    SS_LoopSound(global.sound_handle);



}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>{
    if(stage == 0 &amp;&amp; pause == 0)
    {
        draw_set_font(fnt_Terminal6);
        draw_set_color(16777215);
        draw_set_halign(fa_center);
        
        var weekstring;
        switch(Week)
        {
            case 0:
                weekstring = 'Month 1:#Week 1';
                break;
            case 1:
                weekstring = 'Month 1:#Week 2';
                break;
            case 2:
                weekstring = 'Month 1:#Week 3';
                break;
            case 3:
                weekstring = 'Month 1:#Week 4';
                break;
            case 4:
                weekstring = 'Month 2:#Week 1';
                break;
            case 5:
                weekstring = 'Month 2:#Week 2';
                break;
            case 6:
                weekstring = 'Month 2:#Week 3';
                break;
            case 7:
                weekstring = 'Month 2:#Week 4';
                break;
            case 8:
                weekstring = 'Month 3:#Week 1';
                break;
            case 9:
                weekstring = 'Month 3:#Week 2';
                break;
            case 10:
                weekstring = 'Month 3:#Week 3';
                break;
            case 11:
                weekstring = 'Month 3:#Week 4';
                break;
            case 12:
                weekstring = 'Month 4:#Week 1';
                break;
            case 13:
                weekstring = 'Month 4:#Week 2';
                break;
            case 14:
                weekstring = 'Month 4:#Week 3';
                break;
            case 15:
                weekstring = 'Month 4:#Week 4';
                break;
        }
        
        draw_text(view_xview+(view_wview/2),view_yview+view_hview-32,weekstring);
        
        if(instance_exists(obj_P1))
        {
            draw_set_halign(fa_left);
            draw_sprite(obj_P1.port,0,view_xview+4,view_yview+4);
            draw_rectangle_color(view_xview+4,view_yview+4,view_xview+11,view_yview+11,c_blue,c_blue,c_blue,c_blue,true);
            draw_text(view_xview+16,view_yview+4,string(ds_map_find_value(obj_P1.objMap,'gold'))+'G');
        
        }
        
        if(instance_exists(obj_P2))
        {
            draw_set_halign(fa_right);
            draw_sprite(obj_P2.port,0,view_xview+view_wview-12,view_yview+4);
            draw_rectangle_color(view_xview+view_wview-12,view_yview+4,view_xview+view_wview-5,view_yview+11,c_red,c_red,c_red,c_red,true);
            draw_text(view_xview+view_wview-18,view_yview+4,string(ds_map_find_value(obj_P2.objMap,'gold'))+'G');
        
        }
        
        if(instance_exists(obj_P3))
        {
            draw_set_halign(fa_left);
            draw_sprite(obj_P3.port,0,view_xview+4,view_yview+view_hview-12);
            draw_rectangle_color(view_xview+4,view_yview+view_hview-12,view_xview+11,view_yview+view_hview-5,c_green,c_green,c_green,c_green,true);
            draw_text(view_xview+16,view_yview+view_hview-12,string(ds_map_find_value(obj_P3.objMap,'gold'))+'G');
        
        }
        
        if(instance_exists(obj_P4))
        {
            draw_set_halign(fa_right);
            draw_sprite(obj_P4.port,0,view_xview+view_wview-12,view_yview+view_hview-12);
            draw_rectangle_color(view_xview+view_wview-12,view_yview+view_hview-12,view_xview+view_wview-5,view_yview+view_hview-5,c_white,c_white,c_white,c_white,true);
            draw_text(view_xview+view_wview-18,view_yview+view_hview-12,string(ds_map_find_value(obj_P4.objMap,'gold'))+'G');
        
        }
        
    }


    if(stage &gt; 0)
    {
        draw_sprite(spr_TextBox,0,view_xview,view_yview+48);
    }
    
    if(currentLevel &gt; 0)
    {
        draw_sprite(spr_TextBox,0,view_xview+64,view_yview+128);

    }

}</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
